# 概率论与数理统计

<center><i><font size = '5'>Table of Contents</font></i></center>
[toc]

## Ch1

### 基本

#### 相容与互斥

$$
相容：A \cap B \neq \varnothing\\
互斥：A \cap B = \varnothing\\
$$

#### 独立

$$
Def: P(AB) = P(A)P(B)\\
即P(B|A) = P(B)\ 或\ P(A|B) = P(A)【P(A) \cdot P(B) \neq 0】\\
--相互独立--\\
P(A_{i_1}A_{i_2}...A_{i_n})
= \prod_{i=1}^n P(A_{i_i})\\
相互独立 \Rightarrow 两两独立\\
相互独立 \nLeftarrow 两两独立\\
$$

### 全概率 & Bayes

$$
--划分定义--\\
B_iB_j = \varnothing, \forall i \neq j\\
\bigcup _{i=1}^{n}B_i = S\\
--全概率公式--\\
P(A) = \sum_{i=1}^{n}P(B_i)P(A|B_i)\\
--Bayes公式--\\
P(B_k|A) = \frac{P(B_kA)}{P(A)}
= \frac {P(B_k)P(A|B_k)} {\sum_{i=1}^n P(B_i)P(A|B_i)}\\
(其中B_1, B_2, ..., B_n为S的一个划分)\\
$$

## Ch2

### 离散型(泊松、、、)

**二项分布**

**泊松(Poisson)分布**

* $P(X = K) = \frac {e ^ {-\lambda}\lambda ^ k} {k!}$
* $nota:X\sim P(\lambda)$
* $cha:二项分布中n足够大，p充分小，\lambda = np$
* $E(X) = Var(X) = \lambda$

**超几何分布**

**几何分布**

* $P(X=k) = p(1-p)^{k-1}$
* 表示查到一次 次品 时的检查次数X的分布

**巴斯卡分布**

* $nota: X \sim bsk(r,p)\\P(X = k) = C_{k-1}^{r-1} p^r (1-p)^{k-r},k = r, r+1, ...;r \in Z^+; 0<p<1$
* 表示实验进行到出现r次成功时的实验次数X的分布

### 连续型(均匀、正态、指数)

**UD**

* $nota: X \sim U(a,b)\\$
* $Var(X) = \frac{(b-a)^2}{12}$

**ND**

* $nota: X \sim N(\mu, \sigma^2)$
* $f(x) = \frac 1 {\sqrt{2\pi}\sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}}$

**exp D**

* $nota:X \sim E(\lambda)$
* $ f(x) =  \left \{ \begin{array}{} \lambda e^{-\lambda x} & ,x > 0\\ 0 & ,x \leqslant 0\\ \end{array}\right.\\ F(x) =  \left \{ \begin{array}{} 1 - e^{-\lambda x} & ,x > 0\\ 0 & ,x \leqslant 0\\ \end{array}\right.$
* $无记忆性: P(X > t_0 + t | X > t_0) = P (X > t)\\$
* $E(X) = \frac1\lambda, Var(X) = \frac1{\lambda^2}$


### 正态分布概率计算

$$
P(X \leqslant b) = \Phi(\frac {b-\mu} \sigma)\\
\Phi(x) = 1 - \Phi (-x)
$$

### 随机变量函数、分布函数的换元

$$
已知：Y = g(X), f_X(x)\\
F_Y(y) = P (Y \leqslant y) = P (g(x) \leqslant y)\\
f_Y(y) = \frac {dF_Y} {dy}\\
【Ex. g(X) = |X| \rightarrow P (|X| \leqslant y) = F_X(y) - F_X(-y)
\rightarrow f_Y(y) = f_X(y) + f_X(-y)】\\
--定理--\\
y = g(x) 为严格单调可微函数，值域为D，\\
则f_Y(y) = 
\left \{ \begin{array}{}
	f_X(h(y))|h'(y)| & ,y \in D\\
	0 & ,y \notin D\\
\end{array}\right.
，其中x = h(y)为y = g(x)反函数\\
--推论1--\\
连续型X的 分布函数为F(x), 记 Y = F(X)，则 Y \sim U(0,1)
$$

## Ch3

### 离散

#### 联合

$$
P(x_1 < X \leqslant x_2, y_1 < Y \leqslant y_2) = F(x_2, y_2) - F(x_1, y_2) - F(x_2, y_1) + F(x_1, y_1)\\
$$

#### 边际

$$
P\{ X = x_i \} = \sum_{j=1}^{+\infty}p_{ij} \triangleq p_{i\cdot}
$$

#### 条件

$$
P\{ X=x_i|Y=y_j\} = \frac{P\{ X=x_i,Y=y_j\}}{P\{ Y=y_i\}}
=\frac{p_{ij}}{p_{\cdot j}} \\
F_{Y|X}(y|x) = P(Y \leqslant y | X = x )\\
$$

### 连续

#### 联合

$$
f(x,y) = \frac{\partial^2 F(x,y)}{\partial x \partial y}\\
P\{ (x,y) \in D \} = \mathop\iint_D f(x,y)dxdy
$$

#### 边际

$$
\left \{ \begin{array}{}
	F_X = P\{ X \leqslant x, Y< +\infty\} = F(x,+\infty)
\end{array}\right.\\
\left \{ \begin{array}{}
	f_X(x) = \int_{-\infty}^{+\infty}f(x,v)dv\\
	f_Y(y) = \int_{-\infty}^{+\infty}f(u,y)du\\
\end{array}\right.
$$

#### 条件

$$
Def:F_{Y|X}(y|x) = \lim_{\delta \rightarrow0^+}P\{ Y\leqslant y | x<X\leqslant x+\delta\}
= ... =\int_{-\infty}^y \frac{f(x,v)}{f_X(x)}dv\\
\Longrightarrow f_{X|Y}(x|y) = \frac{f(x,y)}{f_Y(y)}, f_Y(y) \neq 0\\
f(x,y) = f_{X|Y}(x|y)f_Y(y) = f_{Y|X}(y|x)f_X(x)\\
P\{Y \in D_y | X = x\} = \int_{D_y} f_{Y|X}(v|x) dv
= \int_{D_y} \frac {f(x,v)} {f_X(x)}dv = \frac {\int_{D_y} f(x,v)dv} {f_X(x)}\\
若 {D_y} = (a,b), 则为\int_a^b f_{Y|X}(v|x) dv\\
$$

### 分布模型

#### 二元均匀分布

$$

$$

#### 二元正态分布

* $(X,Y) \sim N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)$
* $X \sim N(\mu_1,\sigma_1^2),Y \sim N(\mu_1,\sigma_1^2),即(X,Y)边际分布为一元正态分布$

### 独立性

#### 成立条件

$$
--充要条件--\\
Def: P\{ X \in D_1, Y \in D_2\} = P\{X \in D_1\} \cdot P\{Y \in D_2\}\\
\Rightarrow F(x,y) = F_X(x) \cdot F_Y(y)\\
特别的，
\left \{ \begin{array}{}
	对离散型，有P\{ X=x_i, Y=y_i\} = P\{ X=x_i\}P\{ Y=y_i\}\\
	对连续型，有f(x,y) = f_X(x) \cdot f_Y(y)\\
\end{array} \right.\\
定理：除面积为0的区域外，f(x,y)可表示为m(x )\cdot n(y)\\
--充分条件--\\
--必要条件--\\
相关系数\rho = 0\\
特别的，对于二元正态分布，\rho=0 为充要条件
$$

#### 多元

### 随机变量函数(换元)

#### Z=X+Y

#### 离散型

$$
P\{ Z = z_k\} = P\{X+Y=z_k\} = \sum_{i=1}^{+\infty} P\{ X=x_i,Y=z_k-x_i \}
= \sum_{i=1}^{+\infty} P\{ X=z_k-y_i,Y=y_i \}
$$

| $x_i$ | $y_i$ | $z_i$ | $x_i$ | $z_k-x_i$ |
| :---: | :---: | :---: | :---: | :-------: |
|   1   |   4   |   7   |   1   |     6     |
|   2   |   5   |       |   2   |     5     |
|   3   |   6   |       |   3   |     4     |
|   4   |   7   |       |   4   |    N/A    |
|   5   |   8   |       |   5   |    N/A    |
|   6   |   9   |       |   6   |    N/A    |



#### 连续型

$$
F_Z(z) = P(Z \leqslant z) = P(X+Y \leqslant z)
= \mathop\iint_{x+y\leqslant z} f(x,y)dxdy
= \int_{-\infty}^{+\infty}dx\int_{-\infty}^{z-x}f(x,y)dy
\\
作积分变换
\left \{ \begin{array}{}
	u = x\\
	v = x + y
\end{array} \right.
，在这样的变换下dxdy = dudv
\\
『Proof:dudv = \frac{J_{uv}}{J_{xy}}dxdy = 
\left[ \begin{array}{}
	\frac{\partial u}{\partial x}, \frac{\partial u}{\partial y}\\
	\frac{\partial v}{\partial x}, \frac{\partial u}{\partial y}
\end{array} \right] dxdy =
\left [ \begin{array}{}
	1, 0\\
	1, 1
\end{array} \right]
dxdy = dxdy
』
\\
可得F_z(z) = \int_{-\infty}^z dv \int_{-\infty}^{+\infty}f(u,v-u)du
\\
\therefore f_z(z) = \frac{d\int_{-\infty}^z dv \int_{-\infty}^{+\infty}f(u,v-u)du}{dz} = \int_{-\infty}^{+\infty}f(u,z-u)du\\
求密度函数f_Z的三种算法
\\
\left \{ \begin{array}{}
	f_Z(z) = \int_{-\infty}^{+\infty} f(x,z-x)dx\\
	f_Z(z) = \int_{-\infty}^{+\infty}f_X(x)f_Y(z-x)dx(仅X与Y独立时成立)\\
	f_Z(z) = \frac{dF_Z}{dz}\\
\end{array} \right.
$$

#### 模型
$$
X \sim P(\lambda_1),Y \sim P(\lambda_1) \longrightarrow X+Y \sim P(\lambda_1+\lambda_2)
\\
X \sim B(n_1, p), Y\sim B(n_2, p) \longrightarrow X+Y \sim B(n_1 + n_2, p)
\\
X,Y \sim N(0,1) \longrightarrow X+Y \sim N(0,2)
\\
\Longrightarrow X \sim N(\mu_1, \sigma_1^2),Y \sim N(\mu_2, \sigma_2^2)
\longrightarrow aX+bY+c \sim N(a\mu_1+b\mu_2+c, a^2\sigma_1^2+b^2\sigma_2^2)
$$

#### Z=min/max{X,Y}

$$
F_{max}(z) = P(X \leqslant z, Y \leqslant z) \xlongequal{X,Y独立} F_X(z)F_Y(z)
\\
F_{min}(z) = 1 - P(X > z, Y > z) \xlongequal{X,Y独立} 1- (1-F_X(z)) \cdot (1-F_Y(z))
\\
课本那题好像就是min\{max\{s1,s2\},s3\}\\
推广到n个相互独立的随机变量，分布函数为F_i(t)\\
F_{max}(t) = \prod_{i=1}^n F_i(t)\\
F_{min}(t) = 1 - \prod_{i=1}^n [1-F(t)]
$$

## Ch4

### 期望

#### 定义

$$
E(X) = \sum_{i=i_0}^{+\infty}x_ip_i\\
E(X) = \int_{-\infty}^{+\infty} xf(x)dx
$$

#### 特殊模型

* **泊松分布**
  $$
  E(X) = \sum_{k=0}^{+\infty}k \frac{e^{-\lambda}\lambda^k}{k!}
  = 0 + \lambda e^{-\lambda} \sum_{k'=1}^{+\infty}\frac{\lambda^{(k'-1)}}{(k'-1)!}
  = \lambda e^{-\lambda} \cdot e^\lambda = \lambda
  $$

- **指数分布**
  $$
  E(X) = \int_{0}^{+\infty} x \cdot (\lambda e^{-\lambda x})dx
  \xlongequal{分部求导} -(xe^{-\lambda x})|_{x=0}^{+\infty} + \int_{0}^{+\infty}e^{-\lambda x}dx
  = \frac 1 \lambda
  $$

- **标准N**

  $E(X) = 0$

#### 随机变量函数

$$
Y= g(X), 且 \sum/\int |g(x)|f(x) 存在（绝对收敛） \Longrightarrow E(Y) = \int_{-\infty}^{+\infty} g(x)f(x)dx
\\
h(X,Y)，若\int h(x,y)dxdy绝对收敛 \Longrightarrow E(h(X,Y))
= \iint h(x,y)f(x,y)dxdy
\\
如E(XY) = \int_{-\infty}^{+\infty} \int_{-\infty}^{+\infty} (xy)f(x,y)dydx
$$

#### 性质

**线性组合**

$\displaystyle E(c_0 + \sum_{i=1}^n c_iX_i) = c_0 + \sum_{i=1}^nE(X_i)$

**独立性**

$X,Y独立 \Longrightarrow E(XY) = E(X)E(Y)$

<u>* 此结论为必要不充分条件</u>

#### EG

**Ex1**.**不运用分布律求解期望**(一般<u>利用独立性</u>)

1. 电梯载12人，10层楼全下完，求停留次数X期望
   $X_i = \left \{ \begin{array}{} 1,i层有人下\\ 0,i层无人下\\ \end{array} \right. \\ 则X = \sum X_i \\ \forall i \in [1,10], E(X_i) = P(X_i = 1) = 1 - 0.9^{12} \\ E(X) = 10E(X_i) = $
   
2. n人互赠礼物，求拿到自己礼物人数期望
   $ E(X) = n \times \frac1n = 1 $

### 方差

#### 定义

nota: $Var(X), D(X), V(X),\sigma^2(X)$

Def: $D(X) = E\{[X-E(X)]^2\}$

**导出定理**
$$
D(X) = E(X^2) - E^2(X)
$$

#### 性质

**方差特性**

$Var(aX) = a^2 Var(X)$

$Var(X) = 0 \Longleftrightarrow P(X=const) = 1, const = E(X)$

**线性组合**

==$Var(X+Y) = Var(X)+Var(Y) +2Cov(X,Y)$==

协方差 $Cov(X,Y) \triangleq E[(X-E(X))(Y-E(Y))]$

**独立性**

独立 $\Longrightarrow Cov(X,Y) = 0 \Longrightarrow Var(aX+bY+c) = a^2Var(X) + b^2Var(Y)$

Proof：
$$
E\{[X-E(X)][Y-E(Y)]\}
\xlongequal{独立} E(X-E(X)) \times E(Y-E(Y))
\\
= (E(X)-E(X)) \times (E(Y)-E(Y))
= 0
$$


#### 模型

- **0-1分布**

  $Var(X) = p(1-p)$

- **泊松分布**

  $Var(X) = \lambda$

- **均匀分布**

  $Var(X) = \frac{(b-a)^2}{12}$

- **指数分布**
  
  $Var(X) = \frac{1}{\lambda^2}$
  
- **二项分布**
  
  **暴力算法**
  
  ${\displaystyle X \sim B(n,p)	\\	\displaystyle E(X) = \sum_{k=1}^n k(\frac{n!}{k!(n-k)!})p^k(1-p)^{n-k}	\\	\displaystyle = np \sum_{k=1}^n (\frac{(n-1)!}{(k-1)!(n-k)!})p^{k-1}(1-p)^{n-k}	\\	\displaystyle = np \sum_{k=1}^n C_{n-1}^{k-1}p^{k-1}(1-p)^{(n-1)-(k-1)}\\= np}$
  
  **利用独立性和两点分布结论与方差**
  
  - $X \sim B(n,p),X_i \sim B(p),X = \sum X_i$
  - $E(X) = E(\sum X_i) = \sum E(X_i) = np$
  - $Var(X) = Var(\sum X_i) = \sum Var(X_i) = np(1-p)$
  
- **正态分布**

  - E(X) = μ
  - VAr(X) = σ^2^

  **标准正态分布**

  - E(X) = 0
  - Var(X) = 1

**Ex**.

X~P($\lambda$)，求E(X(X-1)(X-2))

$\displaystyle E(X(X-1)(X-2)) = \sum_{k=0}^\infty k(k-1)(k-2)\frac{\lambda^k e^{-\lambda}}{k!} = 3 \times 0 + \sum_{k=3}^\infty \frac{\lambda^k e^{-\lambda}}{(k-3)!} = \lambda^3$

#### 正态分布性质

$X-Y \sim N(\mu_1-\mu_2, \sigma_1^2 + \sigma_2^2)$

标准化变量：$X^* = \frac{X - \mu}{\sigma}$

#### EG

1. 还是互赠礼物的那题，求X方差
   
   $\displaystyle Var(X_i) = \frac1n(1-\frac1n) \\ \displaystyle E(X_iX_j) = P(ij同时拿到) = \frac1{n(n-1)} \\ \displaystyle Cov(X_i,X_j) = E(X_iX_j)-E(X_i)E(E_j) = \frac1{n(n-1)} - \frac1{n^2} = \frac1{n^2(n-1)} \\ \displaystyle Var(X) = \sum_{i=1}^{n} Var(X_i) + 2\sum_{1 \leqslant i < j \leqslant n} Cov(X_i,X_j) \\ \displaystyle = n \times \frac1n(1-\frac1n) + 2 \times \frac{n(n-1)}2 \times \frac1{n^2(n-1)} = 1$



| 分布      | 分布律或密度函数                                             | 数学期望            | 方差                    |
| --------- | ------------------------------------------------------------ | ------------------- | ----------------------- |
| 0-1分布   |                                                              | $p$                 | $p(1-p)$                |
| B(n,p)    |                                                              | $np$                | $np(1-p)$               |
| P(λ)      | $P(X=k) = \frac{\lambda^ke^{-k}}{k!} \\ k=0,1,2,...$         | ==$\lambda$==       | ==$\lambda$==           |
| U(a,b)    |                                                              | $\frac{a+b}2$       | $\frac{(a-b)^2}{12}$    |
| E(λ) vv   | $f(x) =  \left \{ \begin{array}{} \lambda e^{-\lambda x} & ,x > 0\\ 0 & ,x \leqslant 0\\ \end{array}\right.\\ F(x) =  \left \{ \begin{array}{} 1 - e^{-\lambda x} & ,x > 0\\ 0 & ,x \leqslant 0\\ \end{array}\right.$ | ==$\frac1\lambda$== | ==$\frac1{\lambda^2}$== |
| N(μ,σ^2^) | $f(x) = \frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}}$<br />N/A | $\mu$               | $\sigma^2$              |

<center><b>表：一些模型的数学期望与方差</b></center>

### 协方差

#### 定义

$Cov(X,Y) \triangleq E[(X-E(X))(Y-E(Y))]$

**计算公式**

* $Cov(X,Y) = E(XY) -E(X)E(Y)$
* $\displaystyle Cov(X,Y) = \sum_{i=1}^{+\infty}\sum_{j=1}^{+\infty}(x_i-E(X))(y_j-E(Y))p_{ij}$
* $\displaystyle Cov(X,Y) = \int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}(x-E(X))(y-E(Y))f(x,y)dxdy$

#### 性质

**线性性质**

* $Cov(aX,bY) = ab \cdot Cov(X,Y)$
* $Cov(X_1+X_2,Y) = Cov(X_1,Y) +Cov(X_2,Y)$

**特殊**

* $Cov(X,X) = Var(X)$
* $Var(X)Var(Y) \neq 0时，Cov^2(X,Y) \leqslant Var(X)Var(Y)，当且仅当X与Y有严格线性关系时取等$

**Ex**.

1. $\displaystyle Cov(aX+bY,cX+dY) = acVar(X) + bdVar(Y) + (ad+bc)Cov(X,Y)$
2. $\displaystyle Var(aX+bY+c) = a^2Var(X) + b^2Var(Y) + 2abCov(X,Y)$
3. $\displaystyle Var(\sum_{i=1}^n X_i) = \sum_{i=1}^n Var(X_i) + 2 \sum_{1 \leqslant i<j \leqslant n} Cov(X_i,Y_j)$

### 相关系数ρ

#### 定义

$\rho_{XY} = \frac{Cov(X,Y)}{\sqrt{Var(X)Var(Y)}}	\\	= Cov(\frac{X-E(X)}{\sqrt{Var(X)}},\frac{Y-E(Y)}{\sqrt{Var(Y)}})$

#### 性质

* $|\rho| \leqslant 1$
* $|\rho| = 1 \Longleftrightarrow X,Y间存在严格线性关系(\exist 常数a,b, s.t.P(Y = a + bX) = 1), \\ 特别的,\left\{\begin{array}{}	\rho = 1, b>0 \\ \rho = -1, b<0	\end{array}\right.$

#### 不相关

##### 定义：满足一下三条任一

1. Cox(X, Y) = 0​
2. E(XY) = E(X)·E(Y)
3. Var(X + Y) = Var(X) + Var(Y)

*注：13等价(不相关)，2更强一些(独立)*

特别的，对于二元正态分布N(μ~1~, μ~2~, σ~1~^2^, σ~2~^2^, ρ)，不相关与独立等价





> 随机变量X满足$f(X) = \frac{e^{-|x|}}2,-\infty<x<+\infty$，则如何说明X与|X|是不独立的